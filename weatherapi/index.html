<!DOCTYPE html>
<html lang="en">
<!-- THE API IS REALLY SLOW !! -->

<head>
    <meta charset="utf-8">
    <title>Weather API!</title>
    <!--CSS-->
    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link href="libs/flatUI/dist/css/flat-ui.css" rel="stylesheet">
    <link href="//cdnjs.cloudflare.com/ajax/libs/weather-icons/1.3.2/css/weather-icons.min.css" rel="stylesheet">


    <!-- PERSONNAL CSS STYLESHEET -->
    <!--JS-->
    <script type="text/javascript" src="libs/jquery/dist/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="//maps.googleapis.com/maps/api/js?key=AIzaSyA6OCppSr3hEU5qsC1sFXdf5Sq0oLgbrXY"></script>


    <style>
        .weather {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translateX(-50%) translateY(-50%);
            background-color: #fff;
            border-radius: 5px;
            position: absolute;
            width: 35%;
            padding: 40px 50px;
            display: table;
            .temp {
                display: table-cell;
            }
            #toggle {
                display: none;
            }
        }
    </style>
</head>



<body style="background-color: #34495e">
    <a target="_blank" href="https://github.com/aureleoules/freecodecamp/blob/master/weatherapi/index.html">Source Code</a>
    <div class="weather well">
        <h1 class="text-center">Weather Station:</h1>
        <h6 id="cityname"></h6>

        <h4 id="temperature"></h4>
        <a style="font-size: 35px" id="toggle" href="#">°C</a>
        <div style="float: right">
            <div style="width: 100%;" id="weatherIcon"></div>
            <center><p id="DescTemp"></p></center>

        </div>


    </div>
</body>

<!-- THE API IS REALLY SLOW !! -->
<script>
    var temp;
    var wIcon;
    var city, country;


    $("#toggle").click(function() {
        ($(this).text() === "°C") ? $(this).text("°F"): $(this).text("°C");
        if ($("#toggle").text() === "°C") {
            $("#temperature").text(temp);
        } else {
            $("#temperature").text(((9 * temp) / 5) + 32);
        }
    });

    function getWeather(cityz) {
        $.getJSON("http://api.openweathermap.org/data/2.5/weather?q=" + cityz + "&units=metric&APPID=c6a4ccc3784479c24a2015961270c084", function(json) {
            temp = json.main.temp;
            wIcon = json.weather[0].icon;
            desc = json.weather[0].main;
            $('#DescTemp').text(desc);

            var linkIcon = "http://openweathermap.org/img/w/" + wIcon + ".png";
            $('#weatherIcon').prepend('<img id="theImg" src="' + linkIcon + '"/>')

            $('#temperature').text(temp);

        })
    }
    $(document).ready(function() {
        $.getJSON('http://ipinfo.io', function(data) {
            $('#cityname').text(data.city + ", " + data.country);
            getWeather(data.city);
        });
    });
</script>

</html>
